using System;
using System.Data;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using Azure.Identity;
using Azure.Storage.Blobs;
using ClearBank.Bacs.Transforms.Files;
using Microsoft.Data.SqlClient;
using Microsoft.Extensions.Configuration;
using Microsoft.Extensions.Logging;

namespace LiveDocs.Server.Replacers
{
    public class Std18InfoReplacer : IStd18InfoReplacer
    {
        private readonly IConfiguration _configuration;
        private readonly ILogger<Std18InfoReplacer> _logger;

        public Std18InfoReplacer(IConfiguration configuration, ILogger<Std18InfoReplacer> logger)
        {
            _configuration = configuration;
            _logger = logger;
        }

        public async Task<string> Render(string std18)
        {
            try
            {

                var std18String = @"VOL1OSQYAG                               B70701                                1
HDR1A723888S  1B70701OSQYAG00010001       20197 20203 000000                    
HDR2F1000000100                                   00                            
UHL1 20198999999    000000001 DAILY  001                                        
200362001286270RA60837040449394500000000033814MS F RADU         EXTRASTAFF        EXTRASTAFF L673425
200362001286270RA60837040439216500000000033814MISS I RADU       EXTRASTAFF        EXTRASTAFF L673425
200362001286270RA60837040058409500000000033814MR F RADU         EXTRASTAFF        EXTRASTAFF L673425
200362001286270RA60837040476960500000000033814MR I RADU         EXTRASTAFF        EXTRASTAFF L673425
200362001286270RA60837040294625500000000035174MR E STANCU       EXTRASTAFF        EXTRASTAFF L673425
200000137921020RA60837040575101500000000040430SARA SHELLEY      B4W 434285        BUZZ GROUP L621874
401611514817460RA60837040177858500000000030934P MIRCEA          P MIRCEA          A GOMEZ LTD 162631
200000137921020RA60838910058583500000000042614O CONNOR          B4W 650340        BUZZ GROUP L621874
401611514817460RA60837040581136500000000024972C NITA            C NITA            A GOMEZ LTD 162631
402715148975440RA60837040206041500000000028306N HIRCEAG         000005953         BOLTON SITE 162631
402715148975440RA60837040100936500000000028346D VATRA           000005952         BOLTON SITE 162631
401235115888260RA04060514187732500000000038542NIGEL CHIDUKU     PAYROLL POSTING   DNA CARE SER162631
403526118746750RA60838910173838500000000005200CREDIT UNION      99039             ILB         162631
400814314722590RA60837040149900500000000035000D SANDFORD        2281              FAIRWAY HOME162631
403534339001770RA04060514225188500000000015000OYOGO LTD         B STUDENTSTRETCH  THE MASTER A162631
402510343400190RA04060513489589500000000033032ALASSA LTD        KEYSTONE          KEYSTONE HEA162631
401611326589330RA04060514243314500000000120000MRS NLA WEBSTER   PURCHASE PAYMENT  MANSION HOUS162631
401413939353370RA60838960077328500000000016180M DOLESJI         WEEKLY PAY        ARCHSTONE LI162631
404711128680830RA04060513474856500000000033231WILSON RANGEL GARC04060513474856    SECURE HEALT162631
404745513948190RA60837040401405500000000002616PETR BERKI                          FUTURE CLEAN648030
404745513948190RA60838940033376500000000010215MR BARRY ENGLAND                    FUTURE SOUTH648030
404745513948190RA60838810150609500000000008030S LAKATOSOVA                        FUTURE CLEAN648030
404745513948190RA60838920094094500000000027257RYAN BROWN                          FUTURE CLEAN648030
404745513948190RA60837040029190500000000028407LEONARD DAVID                       FUTURE CLEAN648030
403901115795680RA60838970081808500000000024140L COOKE           KINGDOM           PAYROLL     647932
404625410758610RA60837040418073500000000024910V APOSTOL         WEEKLY PAYROLL    WEEKLY PAY  599008
400623013777600RA60837050018566500000000034466M. MCFARLANE      12583             BEACHCOURT L844412
200000137921020RA60838940170314500000000040442K HEFFERNAN       B4W 650308        BUZZ GROUP L621874
204867731336210RA60837050026771500000000056684MR MICHAEL KEMP   MPU               PAYME LTD   273848
205534204198180RA04060513926478500000000078410MR LEWIS FLEMING 0055720            VITAL HUMAN 440823
200000137921020RA60838910089470500000000027207EILEEN FLYNN      B4W 650338        BUZZ GROUP L621874
205534204198180RA04060513818643500000000042000MULKERRINS ELECTRI056688            VITAL HUMAN 440823
205534204198180RA04060513549165500000000054000TK CONSTRUCTION LT060986            VITAL HUMAN 440823
204867731336210RA04060513470562500000000083040MAC SEAGER RAIL LI0018              PAYME LTD   273848
204388631700390RA60838901060872500000000041616L ECCLESTON       HUDSON            HUDSON ADMIN441104
204388333731500RA60838901146165500000000024538R MORGAN          HUDSON            HUDSON PAYE 441105
231048257278000RA04060513956975500000000002480JANNATH MOSTAFA   TX3376390711XT WIXADYEN N.V.  441271
231048257278000RA04060513563756500000000011168BANAO LONDON LIMITTX3376267811XT WIXADYEN N.V.  441271
231048257278000RA04060514438613500000000008488FAYE MEGAN GOULD  TX3376257711XT WIXADYEN N.V.  441271
231048257278000RA04060514033697500000000028369FTF MUSIC LTD     TX3376251611XT WIXADYEN N.V.  441271
231048257278000RA04060514337449500000000002314SASHA AGNEW       TX3376320311XT WIXADYEN N.V.  441271
231048257278000RA04060513489770500000000026633KENT FRESH        TX3376242211XT WIXADYEN N.V.  441271
231048257278000RA04060513988026500000000006078ELIZABETH WILKINSOTX3376325011XT WIXADYEN N.V.  441271
231048257278000RA04060513766050500000000018618AFU IMPORT AND EXPTX3376279511XT WIXADYEN N.V.  441271
231048257278000RA04060514294587500000000001010TIA WILLIAMS      TX3376271411XT WIXADYEN N.V.  441271
231048257278000RA04060513670940500000000004310SAMUEL DAVID MCKAYTX3376246011XT WIXADYEN N.V.  441271
231048257278000RA04060513844039500000000009729CHRIS EVANS       TX3376370711XT WIXADYEN N.V.  441271
231048257278000RA60838920056230500000000032964SAMUEL SOLOMON    TX3373259411XT GOFADYEN N.V.  441271
231048257278000RA04060514326726500000000141624COVER4MASK        TX3376403311XT WIXADYEN N.V.  441271
231048257278000RA04060514423201500000000011473YORKSHIRE WOLDS PITX3376449011XT WIXADYEN N.V.  441271
231048257278000RA04060513804376500000000002283LITTLE YUM BOX LIMTX3376457811XT WIXADYEN N.V.  441271
200790738241950RA60837040339564500000000015604BREANNA HAYWARD   7000 3832402888 K B HAM CHILDR448871
231048257278000RA04060514098947500000000005050HIDDEN SMILE LIMITTX3376394611XT WIXADYEN N.V.  441271
231048257278000RA04060513725855500000000001891AIDAN SUTTIE      TX3374737211XT GOFADYEN N.V.  441271
207941036569260RA60837050034480500000000024896R JONES-EVANS     R JONES-EVANS     COLTEN CARE 723641
231048257278000RA60837040346056500000000012598LIAM DISS         TX3374661011XT GOFADYEN N.V.  441271
231048190842000RA60837050018094500000000035266I JAMES                             BILFINGER UK994268
204867806201490RA60837040391299500000000032890S C GHENGHEA      TORQUE RETAIL SERVTORQUE RETAI866573
206169200176200RA60837040223000500000000004800MARIA TODEA                         ABP SHREWSBU936808
206169200176200RA60837040152626500000000029139TANCHO PANKOV                       ABP SHREWSBU936808
206169200176200RA60837040675203500000000021431LASZLO BOROS                        ABP SHREWSBU936808
206169200176200RA60837040285189500000000004820STEFAN TODEA                        ABP SHREWSBU936808
200605004784820RA60838910142029500000000026408D CHESTERS        FW128836/14       LEISURE EMPL946934
200605004784820RA60838810135774500000000062218MR SJ OLSON       FW079365/14       LEISURE EMPL946934
208294106109330RA60838810041672500000000065346MISS EUNICE EKENEU1070 0016342500   SANCTUARY CA953079
207891601991090RA60838920152868500000000011930MR K KNOWLES      REF 12515         BULLOUGH    820213
200000908823050RA60837050059661500000000045514MR REUBEN CHAMBERSU816 0502396901   VES UK      848358
404625410758610RA60837040517101500000000024895S BALANUTA        WEEKLY PAYROLL    WEEKLY PAY  599008
401230516701820RA60837040438856500000000039421A ANGHEL          PAYROLL POSTING   PJL RECRUITM710040
401230516701820RA60837040554988500000000035935M SILVIAN         PAYROLL POSTING   PJL RECRUITM710040
401230516701820RA60837040554988500000000036179N GEANINA         PAYROLL POSTING   PJL RECRUITM710040
404622313698060RA04060513574176500000000060000FINN ELECTRICAL LI14947             TECHNICAL RE710104
404622313698060RA04060500005995500000000146448SMARTTECH SECURITY155858            TECHNICAL RE710104
404622313698060RA04060513557493500000000080000JHJ UK FACILITIES 31079             TECHNICAL RE710104
402127213424600RA04060500001134500000000227500GE KIRBY ENGINEERIENERGIPEOPLE      ENERGI RECRU710768
403901915016230RA60838920050666500000000029252W FIELDING        ACE PERSONNEL     ACE PERSONNE865273
400843311120740RA60837040372650500000000001838CLAIRE REARDON    ONGARPLACE        ONGAR PLACE 289277
402518511061470RA60837050225804500000000057692T J COUPLAND                        SWIFT GROUP 843618
402518511061470RA60837050110543500000000071480J A BOWES                           SWIFT GROUP 843618
402518511061470RA60837050024027500000000035133L A SIMPSON                         SWIFT GROUP 843618
403633513309500RA04060513897881500000000222000SN DESIGN ENGINEER                  MTG CONTRACT671834
403633513309500RA04060514378149500000000107448DIMENSIONAL SURVEY                  MTG CONTRACT671834
402432314719290RA04060513759845500000000126075VENTURE CIVIL ENGITSA LTD           TECH SEARCH 508650
403633513309500RA04060513586142500000000219032AV FABRICATING LTD                  MTG CONTRACT671834
403633513309500RA04060513801214500000000107448FAB SURV LTD                        MTG CONTRACT671834
403633513309500RA04060513938519500000000060195LUNPOPS DECOR LTD                   MTG CONTRACT671834
206582702957600RA60837040286673500000000029716ALEXANDRU C CURT  ALEXANDRU C CURT  DRAEFERN LTD822229
400804413959550RA60838810101861500000000027801C DELANEY                           OP CHOC PAYR923698
200000908823050RA60837050025082500000000036392MR SIMON KELLIHER U816 0200402702   VES UK      848358
206582702957600RA60837040640701500000000027245KOUZY KUZIMBILA   KOUZY KUZIMBILA   DRAEFERN LTD822229
206582702957600RA60837040321932500000000027470ALBA RIVAS MURGA  ALBA RIVAS MURGA  DRAEFERN LTD822229
206582702957600RA60837050268252500000000000754P B MAKOY         P B MAKOY         DRAEFERN LTD822229
206582702957600RA60837040341550500000000027340OPRITA PITIGOI    OPRITA PITIGOI    DRAEFERN LTD822229
206582702957600RA60838901153854500000000027690A I SEBASTIAO     A I SEBASTIAO     DRAEFERN LTD822229
206582702957600RA60837040148661500000000031422PETRE ENEA        PETRE ENEA        DRAEFERN LTD822229
206582702957600RA60838440208446500000000029461KEVIN P J GREALLY KEVIN P J GREALLY DRAEFERN LTD822229
206582702957600RA60837040312186500000000034797DAN NEDELCU       DAN NEDELCU       DRAEFERN LTD822229
206582702957600RA60837040372413500000000035500GEORGI STOYCHEV   GEORGI STOYCHEV   DRAEFERN LTD822229
206582702957600RA60837040691020500000000023895SZIMONETTA CHISNYASZIMONETTA CHISNYADRAEFERN LTD822229
206582702957600RA60838901122711500000000014622SHAQUILLE ANDERSONSHAQUILLE ANDERSONDRAEFERN LTD822229
206582702957600RA60837040388646500000000024508ZSOLT HORVATH     ZSOLT HORVATH     DRAEFERN LTD822229
206582702957600RA60838901019775500000000022829TAKATAYU ADOFO    TAKATAYU ADOFO    DRAEFERN LTD822229
203532134374850RA60837050076000500000000055120B HATTON          HUDSON            HUDSON      449126
203532134374850RA04060513473573500000000048461S BAILEY          HUDSON            HUDSON      449126
203532134374850RA04060513563605500000000060720D JOHNSON         HUDSON            HUDSON      449126
203532134374850RA04060513864619500000000136560A COLLINS         HUDSON            HUDSON      449126
203532134374850RA60837040328252500000000042400C BOURCEANU       HUDSON            HUDSON      449126
402559701587980RA60838960100133500000000046114CHLOE ADAMS                         BROTHERS    508924
401708623548450RA60837040692140500000000023124FLORIN-COSMIN BURC1748              COBB EUROPE 505581
400401220893350RA60838870145342500000000008676ZACHARIASZ JANKOWS208967            NAVOLIO LIMI298512
402559701587980RA60838960091916500000000018148YASMIN BURSLAM                      BROTHERS    508924
401204316191600RA60838920183518500000000033331J A HAYES         ACCROL PAPERS LTD ACCROL PAPER273974
202585606431570RA04060514278507500000000025834MATT LEYH         NEST PAYMENT 12951NEST CLIENT 407290
206328032629360RA60837040590887500000000028092MR K CLEMENTS     FRONTLINE RECRUIT FR9         444610
202585606431570RA04060514278507500000000030975MATT LEYH         NEST PAYMENT 15400NEST CLIENT 407290
202585606431570RA04060514278507500000000016048MATT LEYH         NEST PAYMENT 15858NEST CLIENT 407290
200496238074950RA60837040365964500000000024147JOSEPH CLARKE                       A1 PERSONNEL848568
200496238074950RA60837040365964500000000015786JOSEPH CLARKE                       A1 PERSONNEL848568
207289906252480RA60837040067858500000000023880MR B MATONDO      MATBRA            TRIANGLE REC728918
200401930500430RA040535000000255000000000113920                 QMS200529-002437  SUSPENSE    402927
207614504352790RA60837050007467500000000025808WATSON GARY PAUL MRBM 000242        ROUTEC GB LI443136
205541630708910RA04060513597854500000000107002VOLCANIC CHARCOAL INTEGER           INTEGER COMP405401
202585831020170RA60837040288226500000000025350MR M SOSZYNSKI    BW SALARIES       LIGHT ENGINE446681
204363032210160RA60838810124144500000000030816AARON DOUGLAS     PRD 14- 6988      MEYER SCOTT 403158
200789000346300RA60837040473589500000000030734K PETROU                            SUPREME REC 720131
200196732447410RA60837040393046500000000141890AKIN RESOURCES LTD                  FOOTPRINTFRE720131
203532134374850RA60837050057804500000000095020D MOSTYN          HUDSON            HUDSON      449126
200517539925430RA04060514406809500000001616035004000082082      322025458         HMRC VAT    448671
206759431238980RA04130729900772500000001824400519               PIPCLIENTMONEYIN  CAPITA      449156
200771839315790RA60837040287785500000000032669KIERAN HARDING    000011968         HADLEY INDUS842069
208078233151180RA60837040409848500000000028346DAIVA ZUKAUSKIENE                   UK RECRUIT A720131
200517539925430RA04060514088224500000000102000002636139198      348546665         HMRC VAT    448671
200000304688190RA04060514468553500000000255000RUTHERGLEN ENGINEET1L6338279        RANDSTAD CPE622270
200000304688190RA04060513481374500000000137100HARRIS CIVIL ENGINT2L6324745        RANDSTAD CPE622270
200000304688190RA04060513969258500000000088476HUTCHESON ELECTRICT2L6330402        RANDSTAD CPE622270
200000230203120RA04060500001608500000000231000AF NDT SERVICES LTS2L110125         RANDSTAD SOU622270
200000230203120RA04060514270295500000000270000VALVE ASSET SOLUTIS1L117124         RANDSTAD SOU622270
200000738665640RA60838820104324500000000040783C PADHRACZKY      ADIA0083          RANDSTAD SOL622270
200000738665640RA60838901087843500000000024524DARREN GRAHAM     CMWA0818          RANDSTAD SOL622270
200000304688190RA04060513833718500000000157200SH SITE ENGINEERINT1L6230067        RANDSTAD CPE622270
200000738665640RA60838940043576500000000028966KATIE JONES       JCLA0289          RANDSTAD SOL622270
206669403910420RA60837040352285500000000014658ELZBIETA MASLANKA                   OSCAR MAYER 409022
209786702071440RA60838710081054500000000064600CONTIS CARD SOLUTIPA0000842         BROMFORD HOU620342
206669403910420RA60837040323706500000000014002NICOLAE NITA                        OSCAR MAYER 409022
206669403910420RA60837040645673500000000027371PAVLINKA NASKOVA                    OSCAR MAYER 409022
206669403910420RA60837040014541500000000012091MISS SANDRA FIJALK                  OSCAR MAYER 409022
201768304023620RA04060514225188500000000005000OYOGO             CTOYO001       GBPGIRTON COLLE407536
209734404110430RA60837040368777500000000040776M STAVAR                            FOUNTAIN FOO446945
209734404110430RA60837040315797500000000040610V STAVAR                            FOUNTAIN FOO446945
209790406675950RA60837040065294500000000001184A RAFAEL                            VITAL RECR  446945
209790406675950RA60837040737233500000000009592MC DINU                             VITAL RECR  446945
202037107217430RA60837040676374500000000032752E OBIALA          ESSEX GROWERS     ESSEX GROWER446945
209790406675950RA60837040470636500000000027133M VARTOLOMEI                        VITAL RECR  446945
209790406675950RA60837040240126500000000009627V BEJENARA                          VITAL RECR  446945
202569307324940RA60837040465454500000000023545MR M OSTRCILIK    FORTNIGHTLY PAY   INCABROOK LT446945
202037100809420RA60837040388751500000000032044I HEGYI           HERTFORDSHIRE GROWHERTFORDSHIR446945
202037435638980RA60837040352625500000000040013A MARINESCU       GLINWELL          GLINWELL MAR446945
202037435638980RA60837040306623500000000040346J GERGELY         GLINWELL          GLINWELL MAR446945
202037435638980RA60837040518744500000000039047I HARALYI         GLINWELL          GLINWELL MAR446945
202037435638980RA60837040545636500000000040222F GHEORGHE        GLINWELL          GLINWELL MAR446945
200609109106780RA04060513508918500000000042000ARCHIE PROPERTY MA472               LONDON TOKYO446945
203089039568060RA04060513577048500000000038200MGM RAIL  NW  LIMI                  CARRINGTON W446945
203089039568060RA04060513604745500000000038200NA RAIL ENGINEERIN                  CARRINGTON W446945
202037435638980RA60837040334589500000000041615I CUCU            GLINWELL          GLINWELL MAR446945
203089039568060RA04060513779600500000000038200CDGSERVICES LTD                     CARRINGTON W446945
203089039568060RA04060513503073500000000038200G C M SARGEANT LTD                  CARRINGTON W446945
203089039568060RA04060514210434500000000038200SHM19 LTD                           CARRINGTON W446945
204846502348770RA60838810339981500000000008462PALMER K          034378855         NEXT RETAIL 982950
204846502348770RA60837040281698500000000019301MUCENIC V         034381805         NEXT RETAIL 982950
207866504523780RA04060513622735500000000095000BAKHEIT CONSULTINGC461118           CARBON60 TEM401213
202593407147630RA60837040418766500000000013363MS C DALY         PEKTRON           PEKTRON GROU406057
207866504523780RA60838910078088500000000020834MR MAX NEWCOMBE   P456139           CARBON60 TEM401213
200000909499140RA60837040508552500000000030802PATRYK WASKOWSKI                    BLUE ARROW T401213
200000909499140RA60838970028184500000000032370LEON HARDMAN                        BLUE ARROW T401213
207866504523780RA60838810184198500000000047836MR JOHN MCALLEN   P457718           CARBON60 TEM401213
200000909499140RA60837040716104500000000024435CHRISTOPHER SHAUFL                  BLUE ARROW T401213
200000909499140RA60837040086178500000000043826ALEX OBENG NUAMAH                   BLUE ARROW T401213
200000909499140RA60837040486176500000000032485MISS REBEKAH BUTLEP419101           BLUE ARROW T401213
200000909499140RA60838920099509500000000023390KATHERINA BRADFORD                  BLUE ARROW T401213
200000909499140RA60838920014708500000000010288ENGAGE                              BLUE ARROW T401213
206582403367770RA04060514062078500000000036600LEON TENDER HEALTHB07BF4            A24 GROUP   763687
200000909499140RA60838930188881500000000019462CHRISTOPHER FLANAG                  BLUE ARROW T401213
200000909499140RA60837040480607500000000034523SUITS ME                            BLUE ARROW T401213
207217807636670RA04060514247827500000000107500UAV SCOTLAND LTD  1946069           RMS PLC PAYM622602
207217807636670RA04060513861470500000000200000FREWAL LIMITED    1946070           RMS PLC PAYM622602
207217807636670RA04060513934484500000000085000PROPCON LTD       1946080           RMS PLC PAYM622602
207217807636670RA04060514278087500000000111000MOTIUR RAHMAN LTD 1946083           RMS PLC PAYM622602
203089039568060RA04060514191659500000000038200WAYNE.WARD11ENG LT                  CARRINGTON W446945
209561602708060RA04060514044161500000000033550PIORUNSKI LTD     095560            GPS PAYROLL 446945
208420736628020RA04060513832332500000000043765TONNIANTHONY LTD  A00007XY          NURSDOC LIMI446945
201995506315230RA04060513997811500000000016000MISS L A D PARIETTESSEX PURPLE      ESSEX PASS  446945
207858931284310RA60838810213546500000000022000JAMES HENDERSON   VIRTUS            VIRTUS VALID446945
205740307926910RA60837040509567500000000049307MARCIN SKIEPKO                      QUALITY PERS446945
204347133169710RA60837050109138500000000051273A MCMILLAN                          GLOB SHI LTD446945
200262705068690RA60837040545997500000000029360HRISTOV V                           HULME AC SON446945
207353009057980RA60837040176622500000000046250STRAT ALEX        JAC CONST         JAC CON LTD 446945
203964839965810RA60837040827313500000000035680STEFAN-GABRIEL LUT2074              EAST RECRUIT446945
203964839965810RA60837040770834500000000035680GHEORGHE LUTA     2072              EAST RECRUIT446945
203964839965810RA60837040478556500000000038364VIDMANTAS SINICKAS2075              EAST RECRUIT446945
200158237376910RA04060513721994500000000160000INTERSTITIAL LABS 515625 209604     SONOVATE LTD446945
203964839965810RA60837040743675500000000039437EMRAH MUSTAFA     2145              EAST RECRUIT446945
203964839965810RA60837040159051500000000021019PETRICA-ALIN BORS 2186              EAST RECRUIT446945
203964839965810RA60837040674819500000000039925RAMUTE VASILIAUSKI2066              EAST RECRUIT446945
203964839965810RA60837040745597500000000050112ADAM WISZNIEWSKI  2134              EAST RECRUIT446945
203964839965810RA60837040805735500000000011066AKI AYROV         2079              EAST RECRUIT446945
203964839965810RA60837040441148500000000038366FELICIA-ELENA NITA2073              EAST RECRUIT446945
203964839965810RA60837040799751500000000046152DUMITRU-FLORIN DRA2104              EAST RECRUIT446945
207217807636670RA04060513491210500000000071250INSPIRE EDUCATIONA1946765           RMS PLC PAYM622602
207217907636320RA60838920148003500000000030708IAN GARDINER      001-895299N       REED        622602
200771906206450RA60837050033379500000000113058ANNE FILER        FRATTON           VOYAGE      725173
200771906206450RA60838820105592500000000117249CRAIG PASHLEY     CONTIS FIN SERV LTVOYAGE      725173
200771906206450RA60838930062977500000000074656C MARRS           CONTIS FIN SERV LTVOYAGE      725173
200771906206450RA60838440183338500000000000030DANIEL CARTER     CONTIS FIN SERV LTVOYAGE      725173
200771906206450RA60838960026111500000000083735NICHOLAS DYSON    CONTIS FIN SERV LTVOYAGE      725173
200771906206450RA60837050041304500000000115593SCOTT KENDALL     CONTIS FINANCIAL SVOYAGE      725173
200771906206450RA60837040589536500000000109064MISS JADE L YATES CONTIS FINANCIAL SVOYAGE      725173
203550833268960RA04060514301861500000000091936A T S A I LIMITED                   HAYS SPECIAL621802
206333501093630RA60837040394611500000000029610MR I HILA                           BUOYANT WORK855834
206333501093630RA60837040340082500000000004820MR P DODA                           BUOYANT WORK855834
203550833268960RA04060514108532500000000225000CLOUD GOVERNANCE                    HAYS SPECIAL621802
203550833268960RA04060513583737500000000100000BIOTELIC CONSULTI                   HAYS SPECIAL621802
203550833268960RA04060513731177500000000300000EUREG LTD                           HAYS SPECIAL621802
203550833268960RA04060513967888500000000064000IT HUB CONSULTANC                   HAYS SPECIAL621802
203550833268960RA04060513573416500000000690000JXS SOLUTIONS LTD                   HAYS SPECIAL621802
203550833268960RA04060513486747500000000410658LAWRENCE IBEKWE                     HAYS SPECIAL621802
203550833268960RA04060513900240500000000162500MCKIE PROJECT SER                   HAYS SPECIAL621802
203550833268960RA04060513503971500000000252000MANAGEMENT IT LIM                   HAYS SPECIAL621802
203964839965810RA60837040563286500000000027774ANGEL MANOLOV     2171              EAST RECRUIT446945
203964839965810RA60837040441148500000000038366FELICIA-ELENA NITA2071              EAST RECRUIT446945
203964839965810RA60837040805735500000000011066AKI AYROV         2078              EAST RECRUIT446945
200225337441240RA60838810132732500000000094920ARNALDO ALBUQUERQU                  H&W VALETING446945
200225337441240RA60838810372105500000000078750C BIAZUSSI                          H&W VALETING446945
206253807927130RA04060514380818500000000024448CLOSED LIMITED    ST MARTINS        ST MARTINS H446945
207973535097370RA60838820043945500000000050160MISS JENNIFER TOZE1231              WINN SEC LTD446945
209315036549580RA04060513948250500000000304000VW ROOFING        CAROCELLE LLP     CAROCELLE LL446945
202655831979210RA04060514167375500000000003600ECS WHOLESALE LTD INV 12409         CHR-WATCHES 446945
201815809861350RA04047100014806500000000500000PLATFFORM FOR CHANPLATFFORM         PLTFRM FOR C446945
205706104609070RA04060514463495500000000022939AGE CHAUFFEURING S                  EXCEL EXECUT446945
200158032970470RA04060513549830500000000027300WRESTORE          146               MARTENBROOK 446945
204908530742180RA04060513691219500000000080212SEDDON JAMES                        MALLORY  LEI446945
200672607286750RA60838810047573500000000014400T FENNING         SUTTON HOME IMP   SUTTON HOME 446945
200944803335570RA60838810045317500000000030306K BROWN                             THOMPSON  W 446945
206934400529570RA60837050031406500000000026971JEANETTE READ                       CCCS LTD    446945
201792538265540RA60837040531236500000000024462TATARU            GASKAINS LTD      GASKAINS LTD446945
206934400529570RA60837050004700500000000013407K BRIANT                            CCCS LTD    446945
201139836541840RA04060513760023500000000070800MSC SERVICES LONDO                  KEMP RECRUIT446945
203550833268960RA04060513489744500000000220000VLB HR LTD                          HAYS SPECIAL621802
201139836541840RA04060513832196500000000101200TONY S TRANSPORT L                  KEMP RECRUIT446945
203550833268960RA60837050027212500000000034872ELIZABETH HENDERS                   HAYS SPECIAL621802
205534509081930RA60837040207307500000000040634IAN MURRAY        1179793           MORSON HUMAN950860
203550833268960RA04060513906542500000000067770TIGERSOFT LTD                       HAYS SPECIAL621802
204816405957480RA60837000010049500000000190713KANOO HEAD OFFICE 2000108152BLK57020TUI UK LIMIT413251
205534509081930RA60838901175165500000000025980JAMES COOKE       1191741           MORSON HUMAN950860
205534509081930RA60837050032194500000000035187MRS KAREN ELDER   1202828           MORSON HUMAN950860
205534509081930RA04060514196163500000000090317ANDY R FABRICATION1225161           MORSON HUMAN950860
205534509081930RA04060514458646500000000312000CORELL CONSULTING 1237049           MORSON HUMAN950860
205534509081930RA04060513824037500000000080586DARRENMACKENZIE LT1132771           MORSON HUMAN950860
205534509081930RA04060513598230500000000069300DREAMSCAPE COMPOSI811287            MORSON HUMAN950860
205534509081930RA04060513602263500000000065000FATOME LIMITED    1222477           MORSON HUMAN950860
205534509081930RA04060514229950500000000125310GEJ WELD LIMITED  581224            MORSON HUMAN950860
205534509081930RA04060514410015500000000200000H&T CONSULT LIMITE1231232           MORSON HUMAN950860
205534509081930RA04060514125885500000000146880LMG RAILWAYS LIMIT1177994           MORSON HUMAN950860
205534509081930RA04060513724948500000000567000JFW MEDICAL LIMITE1000198           MORSON HUMAN950860
205534509081930RA04060513734470500000000079950HIND AEROSPACE LTD1183420           MORSON HUMAN950860
205534509081930RA04060514150808500000000050921M1 FABRICATION SER1105201           MORSON HUMAN950860
205534509081930RA04060513804465500000000090317LTL FABRICATION LT596845            MORSON HUMAN950860
201139836541840RA04060514113745500000000069200G M COACHES LIMITE                  KEMP RECRUIT446945
205534509081930RA04060513685268500000000084000O J RAIL SERVICES.1169781           MORSON HUMAN950860
201139836541840RA04060513994438500000000054800MULA TRANSPORT LTD                  KEMP RECRUIT446945
201139836541840RA04060513805727500000000064000BAUS SOLUTIONS LTD                  KEMP RECRUIT446945
0404000000317901704040000003179    00020015773202007151206039085CONTRA            DEBIT ACCOUNT     
EOF1A723888S  1B70701OSQYAG00010001       20197 20203                           
EOF2F1000000100                                   00                            
UTL10000020015773000002001577300000010000270        0000000                     ";

                var parsedStd18 = Std18OutputFile.Parse(std18String);

                var stringBuilder = new System.Text.StringBuilder();
                stringBuilder.AppendLine($"| Type | Count | Sum |");
                stringBuilder.AppendLine("|------ | ------ | ------ |");
                stringBuilder.AppendLine($"| Direct Credits | {parsedStd18.DirectCredits.Count()} | £{parsedStd18.DirectCredits.Sum(x => int.Parse(x.AmountInPence)) / 100} |");
                stringBuilder.AppendLine($"| Direct Debits | {parsedStd18.DirectDebits.Count()} | £{parsedStd18.DirectDebits.Sum(x => int.Parse(x.AmountInPence)) / 100} |");
                stringBuilder.AppendLine($"| Recalls | {parsedStd18.Recalls.Count()} | £{parsedStd18.Recalls.Sum(x => int.Parse(x.AmountInPence)) / 100} |");

                return stringBuilder.ToString();

            }
            catch (Exception e)
            {
                _logger.LogError(e, $"Error thrown while rendering std18");
                throw;
            }
        }
    }
}